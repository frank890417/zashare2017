webpackJsonp([1],{"+cgv":function(t,e){},"0nZ0":function(t,e){},"2hYT":function(t,e){},"3f40":function(t,e){},"4qOc":function(t,e){},"6irh":function(t,e){},"7TpH":function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("woOf"),o=a.n(s),n=a("7+uW"),l={name:"app",data:function(){return{activeIndex:"1"}},methods:{handleSelect:function(t,e){console.log(t,e)}}},r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-2 col-nav"},[e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":this.activeIndex},on:{select:this.handleSelect}},[e("el-menu-item",{attrs:{index:"1"}},[e("router-link",{attrs:{to:"/post"}},[this._v("文章管理 ")])],1),e("el-menu-item",{attrs:{index:"2"}},[e("router-link",{attrs:{to:"/company"}},[this._v("攤位管理 ")])],1),e("el-menu-item",{attrs:{index:"3"}},[e("router-link",{attrs:{to:"/cata"}},[this._v("類別管理 ")])],1)],1)],1),e("div",{staticClass:"col-sm-10 offset-2 col-content"},[e("transition",{attrs:{name:"fade",mode:"out-in"}},[e("router-view",{key:this.$route.path})],1)],1),e("div",{staticClass:"col-sm-12"},[e("el-footer")],1)])])])},staticRenderFns:[]};var i=a("VU/8")(l,r,!1,function(t){a("0nZ0")},null,null).exports,c=a("NYxO"),u=a("E8iM"),p=a.n(u);n.default.use(c.a);var d=new c.a.Store({state:{posts:[],catas:[],companies:[]},mutations:{setPosts:function(t,e){t.posts=e},setCatas:function(t,e){t.catas=e},setCompanies:function(t,e){t.companies=e}},actions:{loadWebsite:function(t){t.dispatch("loadPosts")},loadPosts:function(t){p.a.get("/api/spa/post").then(function(e){t.commit("setPosts",e.data)}),p.a.get("/api/spa/cata").then(function(e){t.commit("setCatas",e.data)}),p.a.get("/api/spa/company").then(function(e){t.commit("setCompanies",e.data)})}}}),m=a("/ocq"),f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hello"},[a("h1",[t._v(t._s(t.msg))]),t._v(" "),a("h2",[t._v("Essential Links")]),t._v(" "),t._m(0),t._v(" "),a("h2",[t._v("Ecosystem")]),t._v(" "),t._m(1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[a("a",{attrs:{href:"https://vuejs.org",target:"_blank"}},[t._v("Core Docs")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank"}},[t._v("Forum")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank"}},[t._v("Community Chat")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank"}},[t._v("Twitter")])]),t._v(" "),a("br"),t._v(" "),a("li",[a("a",{attrs:{href:"http://vuejs-templates.github.io/webpack/",target:"_blank"}},[t._v("Docs for This Template")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("a",{attrs:{href:"http://router.vuejs.org/",target:"_blank"}},[this._v("vue-router")])]),this._v(" "),e("li",[e("a",{attrs:{href:"http://vuex.vuejs.org/",target:"_blank"}},[this._v("vuex")])]),this._v(" "),e("li",[e("a",{attrs:{href:"http://vue-loader.vuejs.org/",target:"_blank"}},[this._v("vue-loader")])]),this._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank"}},[this._v("awesome-vue")])])])}]};a("VU/8")({name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App"}}},f,!1,function(t){a("6irh")},"data-v-651ad60c",null).exports;var h={data:function(){return{keyword:"",now_year:"2016"}},mounted:function(){},methods:{handleEdit:function(t){this.$router.push("/post/"+t.id)},handleDelete:function(t,e){var a=this;this.$confirm("你確定要刪除嗎？").then(function(){p.a.post("/api/spa/post/"+e.id,{_method:"DELETE",dataType:"JSON"}).then(function(t){a.$message.success("刪除完成"),a.$store.dispatch("loadWebsite")})})},filterYear:function(t,e){return e.year===t}},computed:Object.assign({},Object(c.b)(["posts"]),{filteredPosts:function(){var t=this;return this.posts.filter(function(e){return""==t.keyword||-1!=JSON.stringify(e).indexOf(t.keyword)}).filter(function(e){return""==t.now_year||e.year==t.now_year}).map(function(t){return Object.assign({},t,{company:t.company&&t.company.name_cht||"-"})})}})},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page manage-post text-left"},[a("h3",[t._v("管理文章")]),a("el-input",{attrs:{placeholder:"輸入關鍵字"},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),a("br"),a("router-link",{staticClass:"btn btn-primary",attrs:{to:"/post/new"}},[t._v("+ 新增文章")]),a("el-select",{model:{value:t.now_year,callback:function(e){t.now_year=e},expression:"now_year"}},[a("el-option",{attrs:{value:"2017",label:"2017"}}),a("el-option",{attrs:{value:"2016",label:"2016"}})],1),a("br"),a("el-table",{attrs:{data:t.filteredPosts,border:"border"}},[a("el-table-column",{attrs:{prop:"id",label:"#",width:"60",sortable:"sortable"}}),a("el-table-column",{attrs:{prop:"company",label:"編號",width:"200",sortable:"sortable"}}),a("el-table-column",{attrs:{prop:"tag",label:"類別",width:"80",sortable:"sortable"}}),a("el-table-column",{attrs:{prop:"cover",label:"封面",width:"120"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{staticClass:"cover",attrs:{src:t.row.cover}})]}}])}),a("el-table-column",{attrs:{prop:"year",label:"年度",width:"100",sortable:"sortable",filters:[{text:"2016",value:"2016"},{text:"2017",value:"2017"}],"filter-method":t.filterYear}}),a("el-table-column",{attrs:{prop:"title",label:"標題"}}),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.handleEdit(e.row)}}},[t._v("編輯")]),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){t.handleDelete(e.$index,e.row)}}},[t._v("刪除")])]}}])})],1)],1)},staticRenderFns:[]};var b=a("VU/8")(h,v,!1,function(t){a("VwUI")},null,null).exports,_={data:function(){return{keyword:"",now_year:"2016"}},mounted:function(){},methods:{handleEdit:function(t){this.$router.push("/company/"+t.id)},filterYear:function(t,e){return e.year===t}},computed:Object.assign({},Object(c.b)(["companies"]),{filteredCompany:function(){var t=this;return this.companies.filter(function(e){return""==t.keyword||-1!=JSON.stringify(e).indexOf(t.keyword)}).filter(function(e){return""==t.now_year||e.year==t.now_year}).map(function(t){return Object.assign({},t)})}})},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page manage-post text-left"},[a("h3",[t._v("管理參展單位")]),a("el-input",{attrs:{placeholder:"輸入關鍵字"},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),a("br"),a("router-link",{staticClass:"btn btn-primary",attrs:{to:"/post/new"}},[t._v("+ 新增文章")]),a("el-select",{model:{value:t.now_year,callback:function(e){t.now_year=e},expression:"now_year"}},[a("el-option",{attrs:{value:"2017",label:"2017"}}),a("el-option",{attrs:{value:"2016",label:"2016"}})],1),a("br"),a("el-table",{attrs:{data:t.filteredCompany,border:"border"}},[a("el-table-column",{attrs:{prop:"id",label:"#",width:"60",sortable:"sortable"}}),a("el-table-column",{attrs:{prop:"name_cht",label:"名字",width:"200",sortable:"sortable"}}),a("el-table-column",{attrs:{prop:"cover",label:"封面",width:"120"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{staticClass:"cover",attrs:{src:t.row.cover}})]}}])}),a("el-table-column",{attrs:{prop:"year",label:"年度",width:"100",sortable:"sortable",filters:[{text:"2016",value:"2016"},{text:"2017",value:"2017"}],"filter-method":t.filterYear}}),a("el-table-column",{attrs:{prop:"discribe_cht",label:"中文敘述",sortable:"sortable"}}),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.handleEdit(e.row)}}},[t._v("編輯")]),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){t.handleDelete(e.$index,e.row)}}},[t._v("刪除")])]}}])})],1)],1)},staticRenderFns:[]};var w=a("VU/8")(_,y,!1,function(t){a("7TpH")},null,null).exports,g={render:function(){var t=this.$createElement;return(this._self._c||t)("h3",[this._v("管理類別")])},staticRenderFns:[]};var k=a("VU/8")({},g,!1,function(t){a("s4x/")},null,null).exports,x=a("m6he"),C={data:function(){return{post:{year:"2017",established_time:(new Date).toLocaleDateString(),short_description:""},create_mode:!1}},mounted:function(){var t=this;this.$route.params.id?this.axios.get("/api/spa/post/"+this.$route.params.id).then(function(e){t.post=e.data}):this.create_mode=!0},components:{VueEditor:x.VueEditor},methods:{handleSave:function(){var t=this;this.create_mode?this.axios.post("/api/spa/post",this.post).then(function(e){t.$message({message:"建立成功",type:"success"}),console.log(e.data.data.id),t.$router.push("/post/"+e.data.data.id)}):this.axios.patch("/api/spa/post/"+this.$route.params.id,this.post).then(function(e){console.log(e.data),"success"==e.data.status?t.$message({message:"儲存成功",type:"success"}):t.$message.error({message:"儲存失敗"})})}},computed:Object.assign({},Object(c.b)(["companies","catas"]),{year_catas:function(){var t=this;return this.catas.filter(function(e){return e.year==t.post.year})}})},E={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"show",rawName:"v-show",value:t.post||t.create_mode,expression:"post || create_mode"}],staticClass:"page manage-post-edit"},[a("div",{staticClass:"container-fluid text-left"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/post"}}},[t._v("文章列表")]),a("el-breadcrumb-item",[t._v("文章編輯")])],1),a("br"),a("br")],1),a("el-form",{staticClass:"container-fluid",attrs:{model:t.post,"label-width":"90px"}},[a("el-header",{staticClass:"header"},[a("el-row",[a("el-col",{attrs:{span:18}},[a("h2",{staticStyle:{"text-align":"left"}},[t.create_mode?a("span",[t._v("新增文章 -")]):a("span",[t._v("編輯文章 -")]),t._v(t._s(t.post.title))])]),a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("儲存更新 ")])],1)],1),a("hr"),a("br"),a("br")],1),a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-3 col-info"},[a("el-form-item",{attrs:{label:"發布狀態"}},[a("el-select",{model:{value:t.post.status,callback:function(e){t.$set(t.post,"status",e)},expression:"post.status"}},[a("el-option",{key:"draft",attrs:{value:"draft",label:"草稿"}}),a("el-option",{key:"published",attrs:{value:"published",label:"已發布"}})],1)],1),a("el-form-item",{attrs:{label:"首頁置頂"}},[a("el-switch",{model:{value:t.post.stick_top_index,callback:function(e){t.$set(t.post,"stick_top_index",e)},expression:"post.stick_top_index"}})],1),a("el-form-item",{attrs:{label:"類別置頂"}},[a("el-switch",{model:{value:t.post.stick_top_cata,callback:function(e){t.$set(t.post,"stick_top_cata",e)},expression:"post.stick_top_cata"}})],1),a("el-form-item",{attrs:{label:"文章類別"}},[a("el-select",{attrs:{placeholder:"請選擇"},model:{value:t.post.cata_id,callback:function(e){t.$set(t.post,"cata_id",e)},expression:"post.cata_id"}},t._l(t.year_catas,function(t){return a("el-option",{attrs:{label:t.name,value:t.id}})}))],1),a("el-form-item",{attrs:{label:"參展單位"}},[a("el-select",{attrs:{filterable:"filterable",placeholder:"請選擇"},model:{value:t.post.company_id,callback:function(e){t.$set(t.post,"company_id",e)},expression:"post.company_id"}},t._l(t.companies,function(t){return a("el-option",{key:t.id,attrs:{label:t.name_cht,value:t.id}})}))],1),a("el-form-item",{attrs:{label:"年份"}},[a("el-select",{model:{value:t.post.year,callback:function(e){t.$set(t.post,"year",e)},expression:"post.year"}},[a("el-option",{attrs:{value:"2016",label:"2016"}}),a("el-option",{attrs:{value:"2017",label:"2017"}})],1)],1),a("el-form-item",{attrs:{label:"撰文者"}},[a("el-input",{model:{value:t.post.author,callback:function(e){t.$set(t.post,"author",e)},expression:"post.author"}})],1),a("el-form-item",{attrs:{label:"上稿時間"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.post.established_time,callback:function(e){t.$set(t.post,"established_time",e)},expression:"post.established_time"}})],1),a("el-form-item",{attrs:{label:"封面圖片"}},[a("el-input",{model:{value:t.post.cover,callback:function(e){t.$set(t.post,"cover",e)},expression:"post.cover"}}),a("img",{staticStyle:{width:"100%"},attrs:{src:t.post.cover}})],1)],1),a("div",{staticClass:"col-sm-9 offset-3 col-content"},[a("el-form-item",{attrs:{label:"標題"}},[a("el-input",{model:{value:t.post.title,callback:function(e){t.$set(t.post,"title",e)},expression:"post.title"}})],1),a("el-form-item",{attrs:{label:"短簡介"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.post.short_description,callback:function(e){t.$set(t.post,"short_description",e)},expression:"post.short_description"}})],1),a("el-form-item",{attrs:{label:"簡介"}},[a("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:t.post.description,callback:function(e){t.$set(t.post,"description",e)},expression:"post.description"}})],1),a("el-form-item",[a("VueEditor",{staticClass:"ve",attrs:{id:"content",useCustomImageHandler:!0},on:{imageAdded:t.handleImageAdded},model:{value:t.post.content,callback:function(e){t.$set(t.post,"content",e)},expression:"post.content"}})],1)],1)])])],1)],1)])])},staticRenderFns:[]};var j=a("VU/8")(C,E,!1,function(t){a("2hYT")},null,null).exports;n.default.use(m.a);var O=new m.a({routes:[{path:"/",redirect:"/post"},{path:"/post",name:"post list",component:b},{path:"/company",name:"company list",component:w},{path:"/cata",name:"cata list",component:k},{path:"/post/new",name:"HelloWorld",component:j},{path:"/post/:id",component:j}]}),S=a("zL8q"),T=a.n(S),V=(a("tvR6"),a("mtWM")),D=a.n(V),H=a("Rf8U"),R=a.n(H),U=a("G0J2"),F=a.n(U);a("3f40"),a("4qOc"),a("+cgv");n.default.use(F.a),n.default.use(R.a,D.a),n.default.use(T.a),n.default.mixin({methods:{strip_tags:function(t){return(""+t).replace(/(<([^>]+)>)/gi,"")},handleImageAdded:function(t,e,a){console.log("get picture!");var s=new FormData;s.append("file",t),console.log(t),D()({url:"/api/upload",method:"POST",data:s}).then(function(t){var s=t.data;e.insertEmbed(a,"image",s)}).catch(function(t){console.log(t)})},cssbg:function(t){return{"background-image":'url("'+t.replace("http://dschool.ntu.edu.tw/assets/","/dschool_old_assets/")+'")'}},scrollTo:function(t,e){var a=o()({pan:0},e);$("html,body").animate({scrollTop:$(t).offset().top+a.pan})}}}),n.default.config.productionTip=!1,d.dispatch("loadWebsite"),new n.default({el:"#app",router:O,store:d,template:"<App/>",components:{App:i}})},VwUI:function(t,e){},"s4x/":function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.eec59721d941598ef766.js.map